<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gen-Z.js Framework Demo</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <nav>
            Test for Genz.js
        </nav>
    </header>
    <section class="container">
      <h1>State Management Demo</h1>
      <input type="text" letz="name" placeholder="Enter your name" />
      <p>Hello, <span getz="name"></span>!</p>
      <button setz="name:John Doe">Set Name to John Doe</button>

      <h2>Hidden Variable Demo</h2>
      <p letz="num1" hidez>3 + 5</p>
      <p letz="num2" hidez>5</p>

        <p>Sum: <span getz="num1"></span></p>

      <a getz="secret"></a>

      <input type="text" letz="count:Number" value="10">                                                                                       
 <p>The count is: <span getz="count"></span></p>                                                                                                                                                                                                                                 
<input type="checkbox" letz="isChecked:Boolean" checked>                                                                                  
 <p>Is checked? <span getz="isChecked"></span></p>                                                                                        
<div letz="user:Object" hidez>{"name": "Alex"}</div> 
<p>User: <span getz="user.name"></span></p>  

 <p letz="fine:Boolean" hidez>1</p>
 <p letz="num1:Number">100</p>

 <p letz="num2:Number">30</p>
 <button setz="numz:num1 - num2">click</button>
 <p setz="something">mo</p>

 <p getz="something"></p>

        <p>Sum of hidden variables: <span getz="num1 + num2"></span></p>
      
        <h2>Object and Array Binding</h2>
        <div letz="person:Object" hidez>{"name": "Alice", "age": 30}</div>
        <p>Name: <span getz="person.name"></span></p>
        <p>Age: <span getz="person.age"></span></p>
    
        <div letz="items:Object" hidez>[1, 2, 3]</div>
        
        <p>First item: <span getz="items[0]"></span></p>

        <h2>Fetch Demo</h2>
        <button fetchz="https://jsonplaceholder.typicode.com/todos/1:todo">Fetch Todo</button>
        <p>Todo Title: <span getz="todo.title"></span></p>
        <p>Completed: <span getz="todo.completed"></span></p>

        <h2>Gemini API Demo (Advanced Fetch)</h2>
        <input type="text" letz="prompt" placeholder="Enter your prompt for Gemini" style="width: 300px;">
        <button clickz="callGeminiAPI()">Ask Gemini</button>
        <h3>Response:</h3>
        <pre><code getz="geminiResponse"></code></pre>

    <script src="script.js"></script>

    <script>
      async function callGeminiAPI() {
        const apiKey = "AIzaSyB1UfoJW3zrw9AuoM5zozA4B2f4QVx6-eA"; // <-- IMPORTANT: REPLACE WITH YOUR KEY
        const url = "https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent";

        // Get the user's prompt from the Gen-Z state
        const userPrompt = window.genZ.state.prompt;

        if (!userPrompt) {
          alert("Please enter a prompt.");
          return;
        }

        const requestBody = {
          "contents": [{
            "parts": [{
              "text": userPrompt
            }]
          }]
        };

        try {
          const response = await fetch(`${url}?key=${apiKey}`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(requestBody),
          });

          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();
          
          // Store the response back into the Gen-Z state
          window.genZ.state.geminiResponse = data;

        } catch (error) {
          console.error('Gemini API error:', error);
          // Store error message in state to display it
          window.genZ.state.geminiResponse = { error: error.message };
        }
      }
    </script>
</body>
</html>